<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>âœ¨ AI PDF Summarizer Pro</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

body {
  margin:0;
  font-family:'Poppins',sans-serif;
  background:linear-gradient(120deg,#0f172a,#1e293b,#3b0764);
  background-size:300% 300%;
  animation:bgShift 10s ease infinite;
  color:#e2e8f0;
  overflow-x:hidden;
}
@keyframes bgShift {0%{background-position:0 50%}50%{background-position:100% 50%}100%{background-position:0 50%}}

h1 {
  text-align:center;
  margin-top:30px;
  font-size:2rem;
  background:linear-gradient(90deg,#06b6d4,#a855f7);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  text-shadow:0 0 15px #06b6d4;
}

.container {
  max-width:900px;
  margin:30px auto;
  padding:25px;
  background:rgba(255,255,255,0.06);
  border-radius:20px;
  box-shadow:0 0 25px rgba(168,85,247,0.2);
}

.upload-box {
  border:2px dashed rgba(255,255,255,0.2);
  border-radius:12px;
  padding:40px;
  text-align:center;
  transition:.3s;
}
.upload-box:hover {background:rgba(255,255,255,0.07);transform:scale(1.02);}
input[type=file]{display:none;}

button {
  background:linear-gradient(90deg,#7c3aed,#06b6d4);
  border:none;
  color:white;
  font-weight:600;
  border-radius:8px;
  padding:10px 18px;
  margin:8px;
  cursor:pointer;
  transition:.3s;
}
button:hover{transform:scale(1.05);box-shadow:0 0 10px #06b6d4;}

.result {
  margin-top:20px;
  padding:15px;
  border-radius:10px;
  background:rgba(255,255,255,0.08);
  white-space:pre-wrap;
  line-height:1.6;
  font-size:15px;
  color:#f1f5f9;
  box-shadow:inset 0 0 15px rgba(56,189,248,0.15);
  min-height:150px;
}

.orb {
  width:80px;
  height:80px;
  border-radius:50%;
  margin:25px auto;
  background:radial-gradient(circle at 30% 30%,#06b6d4,#7c3aed);
  animation:float 3s ease-in-out infinite;
  box-shadow:0 0 25px #06b6d4;
  display:flex;align-items:center;justify-content:center;
  color:white;font-weight:700;font-size:18px;
}
@keyframes float {0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}

#status {text-align:center;margin-top:10px;color:#38bdf8;}

#history {
  margin-top:25px;
  border-top:1px solid rgba(255,255,255,0.1);
  padding-top:10px;
}

.history-item {
  background:rgba(255,255,255,0.07);
  margin-top:8px;
  padding:10px;
  border-radius:8px;
  font-size:0.9rem;
}

.theme-toggle {
  position:fixed;
  top:20px;right:25px;
  cursor:pointer;
  font-size:22px;
  color:#a5f3fc;
}

/* ðŸŒŸ Progress Bar Styles */
.progress-container {
  width:100%;
  height:8px;
  background:rgba(255,255,255,0.1);
  border-radius:10px;
  overflow:hidden;
  margin-top:15px;
  display:none;
}
.progress-bar {
  height:100%;
  width:0;
  background:linear-gradient(90deg,#06b6d4,#a855f7,#06b6d4);
  background-size:200% 100%;
  animation:progressGlow 2s linear infinite;
  transition:width 0.4s ease;
}
@keyframes progressGlow {
  0%{background-position:0% 50%;}
  100%{background-position:200% 50%;}
}
</style>
</head>
<body>

<h1>âœ¨ AI PDF Summarizer Pro</h1>
<div class="theme-toggle" id="themeToggle">ðŸŒ™</div>

<div class="container">
  <div class="orb" id="orb">AI</div>
  <div class="upload-box" id="uploadBox">
    ðŸ“„ Click or drag a PDF here
    <input type="file" id="fileInput" accept="application/pdf">
  </div>

  <div class="progress-container" id="progressContainer">
    <div class="progress-bar" id="progressBar"></div>
  </div>

  <div style="text-align:center;margin-top:15px;">
    <button id="summBtn">Summarize</button>
    <button id="shortBtn">Shorten</button>
    <button id="expandBtn">Expand</button>
    <button id="rephraseBtn">Rephrase</button>
    <button id="speakBtn">Speak</button>
    <button id="copyBtn">Copy</button>
    <button id="pdfBtn">Download PDF</button>
    <button id="tipBtn">AI Tip</button>
    <button id="clearBtn">Clear</button>
  </div>

  <div id="status"></div>
  <div id="result" class="result">ðŸª„ Awaiting your magic PDF...</div>

  <div id="history"><h3>ðŸ“œ Summary History</h3><div id="historyList"></div></div>
</div>

<script>
const BACKEND_URL="https://ai-backend-4-78b9.onrender.com";
let lastSummary="";
const orb=document.getElementById("orb"),
fileInput=document.getElementById("fileInput"),
result=document.getElementById("result"),
statusDiv=document.getElementById("status"),
historyList=document.getElementById("historyList"),
progressContainer=document.getElementById("progressContainer"),
progressBar=document.getElementById("progressBar");

document.getElementById("uploadBox").onclick=()=>fileInput.click();
document.getElementById("summBtn").onclick=()=>summarize();
document.getElementById("shortBtn").onclick=()=>shorten();
document.getElementById("expandBtn").onclick=()=>expand();
document.getElementById("rephraseBtn").onclick=()=>rephrase();
document.getElementById("speakBtn").onclick=()=>speak();
document.getElementById("copyBtn").onclick=()=>copyText();
document.getElementById("pdfBtn").onclick=()=>downloadPDF();
document.getElementById("clearBtn").onclick=()=>clearAll();
document.getElementById("tipBtn").onclick=()=>showTip();
document.getElementById("themeToggle").onclick=()=>toggleTheme();

async function summarize(){
  const f=fileInput.files[0];
  if(!f)return alert("Select a PDF first!");
  orbTalk("Summarizing...");
  result.textContent="â³ Analyzing document...";
  startProgress();
  try{
    const fd=new FormData();
    fd.append("file",f);
    const res=await fetch(`${BACKEND_URL}/summarize`,{method:"POST",body:fd});
    const data=await res.json();
    stopProgress();
    if(data.error){result.textContent="âš ï¸ "+data.error;return;}
    lastSummary=data.summary||"No summary generated.";
    typeWriter(result,lastSummary);
    saveHistory(f.name,lastSummary);
  }catch(e){
    stopProgress();
    result.textContent="âŒ Failed to fetch: "+e.message;
  }
}

/* ðŸŒˆ Progress Bar Logic */
let progressInterval;
function startProgress(){
  progressContainer.style.display="block";
  progressBar.style.width="0%";
  let width=0;
  progressInterval=setInterval(()=>{
    width+=5;
    if(width>95)width=95;
    progressBar.style.width=width+"%";
  },200);
}
function stopProgress(){
  clearInterval(progressInterval);
  progressBar.style.width="100%";
  setTimeout(()=>progressContainer.style.display="none",800);
}

function typeWriter(el,text,i=0){
  el.textContent="";
  if(i<text.length){el.textContent+=text.charAt(i);setTimeout(()=>typeWriter(el,text,i+1),10);}
  else el.textContent=text;
}
function shorten(){
  if(!lastSummary)return alert("No summary yet!");
  const s=lastSummary.split(". ").slice(0,3).join(". ")+".";
  result.textContent=s;
}
function expand(){
  if(!lastSummary)return alert("No summary yet!");
  result.textContent=lastSummary+" It elaborates on these points for deeper understanding.";
}
function rephrase(){
  if(!lastSummary)return alert("No summary yet!");
  result.textContent=lastSummary.replace(/important/gi,"crucial").replace(/difficult/gi,"challenging")+" (Simplified)";
}
function speak(){
  if(!lastSummary)return alert("Nothing to read!");
  const sp=new SpeechSynthesisUtterance(lastSummary);
  sp.pitch=1;sp.rate=1;speechSynthesis.speak(sp);
}
function copyText(){
  navigator.clipboard.writeText(result.textContent);
  alert("Copied summary!");
}
function downloadPDF(){
  const blob=new Blob([result.textContent],{type:"text/plain"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="AI_Summary.txt";
  a.click();
}
function showTip(){
  const tips=[
    "ðŸ’¡ Use AI summaries to revise before exams!",
    "ðŸ“š Shorten mode gives the top 3 insights fast.",
    "ðŸŽ¨ Try switching to light mode during presentations!",
    "ðŸŽ§ Use Speak mode to listen while you read!",
    "âœ¨ Each summary is unique â€” compare two PDFs!"
  ];
  result.textContent=tips[Math.floor(Math.random()*tips.length)];
  orbTalk("AI Tip shared!");
}
function orbTalk(msg){
  orb.textContent="ðŸ’¬";
  statusDiv.textContent=msg;
  setTimeout(()=>{orb.textContent="AI";statusDiv.textContent="";},1500);
}
function clearAll(){
  result.textContent="ðŸª„ Awaiting your magic PDF...";
  statusDiv.textContent="";
}
function saveHistory(name,summary){
  const h=JSON.parse(localStorage.getItem("summHist")||"[]");
  h.unshift({name,summary,time:new Date().toLocaleString()});
  if(h.length>10)h.pop();
  localStorage.setItem("summHist",JSON.stringify(h));
  renderHistory();
}
function renderHistory(){
  const h=JSON.parse(localStorage.getItem("summHist")||"[]");
  historyList.innerHTML=h.length?h.map(x=>`<div class='history-item'><b>${x.name}</b><br>${x.summary.slice(0,80)}...<br><em>${x.time}</em></div>`).join(""):"<em>No history yet.</em>";
}
function toggleTheme(){
  document.body.classList.toggle("light");
  if(document.body.classList.contains("light")){
    document.body.style.background="#f8fafc";
    document.body.style.color="#111";
  }else{
    document.body.style.background="";
    document.body.style.color="";
  }
}
renderHistory();
</script>
</body>
</html>
