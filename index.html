<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‚ú® AI PDF Summarizer Assistant</title>
  <style>
    :root {
      --bg-light: linear-gradient(135deg, #f0f9ff, #e0f2fe);
      --bg-dark: linear-gradient(135deg, #0f172a, #1e293b);
      --text-light: #111;
      --text-dark: #f8fafc;
    }
    body {
      font-family: "Poppins", sans-serif;
      background: var(--bg-light);
      color: var(--text-light);
      transition: all 0.5s ease;
      margin: 0;
      padding: 0;
    }
    .dark-mode {
      background: var(--bg-dark);
      color: var(--text-dark);
    }
    .container {
      max-width: 700px;
      margin: 60px auto;
      text-align: center;
      padding: 20px;
    }
    h1 { color:#2563eb; }
    .glass {
      background: rgba(255,255,255,0.15);
      backdrop-filter: blur(10px);
      border-radius:16px;
      box-shadow:0 8px 32px rgba(31,38,135,0.1);
      margin-top:20px;
      padding:20px;
      transition:0.3s;
    }
    .glass:hover { transform: scale(1.01); }
    button {
      background:#2563eb;
      color:#fff;
      border:none;
      border-radius:8px;
      padding:10px 20px;
      cursor:pointer;
      transition:0.3s;
    }
    button:hover { background:#1e3a8a; }
    input[type="file"] { margin-top:10px; }
    .progress-bar {
      width:100%;height:8px;background:#e5e7eb;border-radius:8px;margin-top:10px;overflow:hidden;display:none;
    }
    .progress-bar div { height:100%;width:0%;background:#2563eb;transition:width 0.4s ease; }
    .output-box { text-align:left; }
    .result { white-space:pre-wrap;min-height:100px;margin-top:10px; }
    .actions { margin-top:10px;display:flex;gap:10px; }
    .history-box {
      margin-top:30px;background:#f9fafb;padding:20px;border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,0.1);
    }
    .history-box ul { list-style:none;padding:0;margin:0; }
    .history-box li { padding:8px;border-bottom:1px solid #ddd;font-size:14px;display:flex;justify-content:space-between; }
    .theme-btn {
      position:fixed;bottom:20px;right:20px;font-size:20px;border-radius:50%;width:45px;height:45px;
    }
    .dark-mode .glass { background:rgba(30,41,59,0.4);color:#f8fafc; }
    /* ‚ú® Orb Mascot */
    .ai-orb {
      position:fixed;bottom:150px;right:120px;width:80px;height:80px;border-radius:50%;
      background:radial-gradient(circle at 30% 30%,#60a5fa,#2563eb);
      box-shadow:0 0 40px #3b82f6,0 0 80px rgba(37,99,235,0.4);
      animation:floaty 4s ease-in-out infinite, glow 3s ease-in-out infinite;
      pointer-events:none;z-index:1000;
    }
    .orb-glow { position:absolute;width:100%;height:100%;border-radius:50%;
      background:radial-gradient(circle,rgba(255,255,255,0.8),transparent);
      animation:shimmer 2s ease-in-out infinite alternate;
    }
    @keyframes floaty { 0%,100%{transform:translateY(0);}50%{transform:translateY(-15px);} }
    @keyframes glow { 0%,100%{box-shadow:0 0 40px #3b82f6,0 0 80px rgba(37,99,235,0.3);}
                      50%{box-shadow:0 0 50px #93c5fd,0 0 120px rgba(147,197,253,0.5);} }
    @keyframes shimmer { from{opacity:0.6;}to{opacity:1;} }
    /* üí¨ AI Speech Bubble */
    .ai-speech {
      position:absolute;bottom:-60px;left:50%;transform:translateX(-50%);
      background:rgba(255,255,255,0.9);color:#1e3a8a;font-size:14px;
      padding:10px 14px;border-radius:20px;white-space:nowrap;
      box-shadow:0 3px 10px rgba(0,0,0,0.1);opacity:0;
      transition:all 0.4s ease;pointer-events:none;
    }
    .dark-mode .ai-speech { background:rgba(30,41,59,0.9);color:#e0f2fe; }
    .ai-speech.show { opacity:1;transform:translateX(-50%) translateY(-5px); }
    .ai-speech::after {
      content:'';position:absolute;bottom:-8px;left:50%;transform:translateX(-50%);
      border-width:8px;border-style:solid;
      border-color:rgba(255,255,255,0.9) transparent transparent transparent;
    }
    .dark-mode .ai-speech::after {
      border-color:rgba(30,41,59,0.9) transparent transparent transparent;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üìÑ AI PDF Summarizer</h1>
    <p class="subtitle">Upload a PDF and let AI summarize it instantly ‚ú®</p>

    <div class="upload-box glass">
      <input type="file" id="pdfFile" accept="application/pdf" />
      <button id="summarizeBtn">‚ö° Summarize</button>
    </div>

    <div id="progressBar" class="progress-bar"><div id="progress"></div></div>
    <div id="loading" style="display:none;">‚è≥ Summarizing...</div>

    <div class="output-box glass">
      <h2>üß† Summary</h2>
      <div id="result" class="result"></div>
      <div class="actions">
        <button id="copyBtn">üìã Copy</button>
        <button id="downloadBtn">‚¨áÔ∏è Download</button>
      </div>
    </div>

    <div class="history-box glass">
      <h2>üìú History</h2>
      <ul id="historyList"></ul>
    </div>

    <button id="themeToggle" class="theme-btn">üåô</button>
  </div>

  <!-- ü™Ñ Orb + Speech -->
  <div id="aiOrb" class="ai-orb" style="display:none;">
    <div class="orb-glow"></div>
    <div id="aiSpeech" class="ai-speech"></div>
  </div>

  <script>
    const BACKEND_URL = "https://ai-backend-3-aepo.onrender.com"; // replace with your Render URL
    let history = JSON.parse(localStorage.getItem("pdfHistory")) || [];
    const aiOrb = document.getElementById("aiOrb");
    const aiSpeech = document.getElementById("aiSpeech");

    function aiSpeak(text) {
      aiSpeech.textContent = "";
      aiSpeech.classList.add("show");
      let i=0;const interval=setInterval(()=>{
        aiSpeech.textContent+=text[i];i++;
        if(i>=text.length)clearInterval(interval);
      },40);
    }
    function aiHideSpeech(delay=1500){setTimeout(()=>aiSpeech.classList.remove("show"),delay);}

    function typeEffect(el,text,speed=20){
      el.innerText="";let i=0;
      const interval=setInterval(()=>{
        el.innerText+=text[i];i++;
        if(i>=text.length)clearInterval(interval);
      },speed);
    }

    document.getElementById("summarizeBtn").addEventListener("click",async()=>{
      const file=document.getElementById("pdfFile").files[0];
      const resultDiv=document.getElementById("result");
      const progress=document.getElementById("progress");
      const bar=document.getElementById("progressBar");
      const loading=document.getElementById("loading");
      if(!file)return alert("Please select a PDF file first!");
      const formData=new FormData();formData.append("file",file);
      resultDiv.innerText="";bar.style.display="block";progress.style.width="0%";loading.style.display="block";
      let width=0;const interval=setInterval(()=>{if(width<90){width+=10;progress.style.width=width+"%";}},400);
      aiOrb.style.display="block";aiSpeak("I'm analyzing your document...");
      try{
        const res=await fetch(`${BACKEND_URL}/summarize`,{method:"POST",body:formData});
        aiSpeak("Almost done summarizing...");
        const data=await res.json();clearInterval(interval);progress.style.width="100%";loading.style.display="none";
        const summary=data.summary||"No summary generated.";
        typeEffect(resultDiv,summary);
        aiSpeak("Here‚Äôs your summary!");aiHideSpeech(3000);
        setTimeout(()=>aiOrb.style.display="none",4000);
        const entry={id:Date.now(),name:file.name,summary,time:new Date().toLocaleString()};
        history.unshift(entry);
        localStorage.setItem("pdfHistory",JSON.stringify(history));
        renderHistory();
      }catch(err){
        clearInterval(interval);
        resultDiv.innerText="‚ùå Error: "+err.message;
        loading.style.display="none";
        aiSpeak("Oops, something went wrong!");aiHideSpeech(3000);
        setTimeout(()=>aiOrb.style.display="none",4000);
      }
    });

    function renderHistory(){
      const list=document.getElementById("historyList");list.innerHTML="";
      if(history.length===0){list.innerHTML="<li>No history yet.</li>";return;}
      history.forEach(h=>{
        const li=document.createElement("li");
        li.innerHTML=`<strong>${h.name}</strong><small>${h.time}</small><button>View</button>`;
        li.querySelector("button").addEventListener("click",()=>{document.getElementById("result").innerText=h.summary;});
        list.appendChild(li);
      });
    }
    renderHistory();

    document.getElementById("copyBtn").addEventListener("click",()=>{
      const text=document.getElementById("result").innerText;
      navigator.clipboard.writeText(text);alert("‚úÖ Summary copied!");
    });
    document.getElementById("downloadBtn").addEventListener("click",()=>{
      const text=document.getElementById("result").innerText;
      const blob=new Blob([text],{type:"text/plain"});
      const link=document.createElement("a");link.href=URL.createObjectURL(blob);
      link.download="AI_Summary.txt";link.click();
    });
    document.getElementById("themeToggle").addEventListener("click",()=>{
      document.body.classList.toggle("dark-mode");
      const icon=document.getElementById("themeToggle");
      icon.textContent=document.body.classList.contains("dark-mode")?"‚òÄÔ∏è":"üåô";
    });
    document.addEventListener("mousemove",(e)=>{
      const x=e.clientX/window.innerWidth*30;
      const y=e.clientY/window.innerHeight*30;
      aiOrb.style.transform=`translate(${x}px,${-y}px)`;
    });
  </script>
</body>
</html>
